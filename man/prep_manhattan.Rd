% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mod_manhattan.R
\name{prep_manhattan}
\alias{prep_manhattan}
\title{Prepare Data for GWAS Manhattan Plot}
\usage{
prep_manhattan(df, chr_col = "CHR", bp_col = "BP", p_col = "P")
}
\arguments{
\item{df}{A data.frame containing at least the following columns:
\itemize{
\item CHR: chromosome identifier
\item BP: base-pair position
\item P: p-value
}}

\item{chr_col}{Name of the chromosome column (string). Default: "CHR"}

\item{bp_col}{Name of the base-pair position column (string). Default: "BP"}

\item{p_col}{Name of the p-value column (string). Default: "P"}
}
\value{
A list with components:
\itemize{
\item df: The input data.frame augmented with \code{pos_cum}, \code{logP}, and \code{tooltip} columns.
\item axis_df: A data.frame of chromosome centers for x-axis breaks (\code{chr}, \code{center}).
\item xrange: Numeric vector of length 2 specifying the cumulative position range.
\item yrange: Numeric vector of length 2 specifying the y-axis plotting range.
}
}
\description{
Process a GWAS result data.frame to compute cumulative SNP positions, -log10(p-values),
and interactive tooltips, as well as x- and y-axis ranges for an interactive Manhattan plot.
}
\examples{
# Synthetic example
df_example <- data.frame(
  CHR = rep(1:3, each = 5),
  BP  = rep(seq(1e6, 5e6, by = 1e6), 3),
  P   = runif(15, 1e-9, 1)
)
res <- prep_manhattan(df_example)
str(res)

# Real GWAS dataset example
assoc <- read.table("output_gwas_results.assoc.logistic",
                    header = TRUE, stringsAsFactors = FALSE)

# Prepare tooltip
assoc$tooltip <- paste0(
  "CHR: ", assoc$CHR,
  "\\\\nBP: ", assoc$BP,
  "\\\\nP: ", signif(assoc$P, 3),
  if ("SNP" \%in\% names(assoc)) paste0("\\\\nSNP: ", assoc$SNP) else ""
)

# Process cumulative position
manhattan_data <- prep_manhattan(assoc)

# Plot using a basic Manhattan plot function
manhattan_plot <- plot_manhattan_bg(assoc)
print(manhattan_plot)

# Save to file
ggsave("manhattan_plot.png", manhattan_plot, width = 10, height = 5, dpi = 300)

}
